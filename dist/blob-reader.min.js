!function(t){"use strict";function n(){var t=new ArrayBuffer(4),n=new Uint8Array(t),r=new Uint32Array(t);if(n[0]=161,n[1]=178,n[2]=195,n[3]=212,3569595041===r[0])return i.ENDIANNESS.LITTLE_ENDIAN;if(2712847316===r[0])return i.ENDIANNESS.BIG_ENDIAN;throw new Error("Unrecognized endianness")}function i(t,r,e){return this instanceof i?(this._blob=t,this._position=0,this._queue=[],this._currentEndianness=e||n(),this._dataEndianness=r||this._currentEndianness,this._pendingTask=!1,void(this._currentResult=null)):new i(t,r,e)}function r(){var t=this._queue.shift();if(t){if(this._position+t.count>this._blob.size)throw new Error("Limit reached. Trying to read "+(this._position+t.count)+" bytes out of "+this._blob.size+".");var n=new FileReader;this._pendingTask=!0,n.onload=function(n){var i=n.target.result;this._pendingTask=!1,t.cb(i),r.call(this)}.bind(this),n.onerror=function(){throw new Error("Error while reading the blob")},t.type||(t.type=i.BINARY_STRING),n["readAs"+t.type](this._blob.slice(this._position,this._position+t.count)),this._position+=t.count}}function e(t,n){for(var i=0;i<t.length;i+=1)t[i]=n(t[i]);return t}function s(t,n,i,r){this._currentResult||(this._currentResult={}),n=(n||1)*i;var e=function(n){var e=8*i,s=window["Uint"+e+"Array"];n=new s(n),this._currentEndianness!==r&&(n=o["swap"+e](n)),this._currentResult[t]=n}.bind(this);return this.readArrayBuffer(n,e)}i.ARRAY_BUFFER="ArrayBuffer",i.BINARY_STRING="BinaryString",i.TEXT="Text",i.DATA_URL="DataURL",i.ENDIANNESS={BIG_ENDIAN:"BIG_ENDIAN",LITTLE_ENDIAN:"LITTLE_ENDIAN"},i.prototype.setDataEndianness=function(t){this._dataEndianness=t},i.prototype.read=function(t,n,i){return"string"==typeof t&&(i=n,t=void 0,n=t),void 0===t&&(t=this._blob.size-this._position),"function"==typeof t&&(i=t,n=void 0,t=this._blob.size-this._position),"function"==typeof n&&(i=n,n=void 0),this._queue.push({count:t,cb:i,type:n}),this._pendingTask||r.call(this),this},i.prototype.readText=function(t,n){return this.read(t,i.TEXT,n)},i.prototype.readArrayBuffer=function(t,n){return this.read(t,i.ARRAY_BUFFER,n)},i.prototype.readBinaryString=function(t,n){return this.read(t,i.BINARY_STRING,n)},i.prototype.readDataURL=function(t,n){return this.read(t,i.DATA_URL,n)};var o={swap8:function(t){return e(t,function(t){return t})},swap16:function(t){return e(t,function(t){return(255&t)<<8|t>>8&255})},swap32:function(t){return e(t,function(t){return(255&t)<<24|(65280&t)<<8|t>>8&65280|t>>24&255})}};i.prototype.readUint8=function(t,n,i){return s.call(this,t,n,1,i||this._dataEndianness)},i.prototype.readUint16=function(t,n,i){return s.call(this,t,n,2,i||this._dataEndianness)},i.prototype.readUint32=function(t,n,i){return s.call(this,t,n,4,i||this._dataEndianness)},i.prototype.readBlob=function(t,n){var i=this._blob.slice(this._position,this._position+n);return this._queue.push({count:n,cb:function(){this._currentResult[t]=i}.bind(this)}),this},i.prototype.commit=function(t){if(!this._currentResult)throw new Error("Cannot commit without any reads");var n=this._currentResult,r={count:0,type:i.ARRAY_BUFFER,cb:function(){t(n),this._currentResult=null}.bind(this)};return this._queue.push(r),this},t.BlobReader=i}(window);